# План прибирання репозиторію Avtoservis 2.0

Мета: зробити репо зрозумілим (одна “канонічна” документація), прибрати мертві/дубльовані файли, і винести тимчасові заглушки в явний dev-режим або прибрати.

## 0) Принципи

1. **Нічого не видаляємо “вслепу”**: кожен файл-кандидат перевіряється на імпорти/використання.
2. **Архівація краще за видалення** для документів/скриптів: спочатку переносимо в `docs/_archive/`.
3. **Одна правда**: у репо має бути один набір актуальних документів в `docs/`.

## 1) Нормалізація документації (високий пріоритет)

### 1.1 Визначити “канонічну” документацію

Фактичний стек репо зараз: **Node/Express + Cloudflare D1 (SQLite)**, web (React/Vite), mobile (Expo/RN), telegram-bot.

У `.trae/documents/` є кілька PRD/архітектурних варіантів. Тому:

- `docs/` = єдина підтримувана документація.
- `.trae/documents/` = генерації/чернетки, не вважаються джерелом істини.

### 1.2 Архівувати застарілі “топ-рівневі” документи (✅ Done)

Кандидати в архів (позначити як legacy/застарілі або перенести в `docs/_archive/`):

- `AUDIT_REPORT.md` (moved)
- `DEBUGGING_PLAN.md` (moved)

Причина: ці файли були автогенеровані й користувач їх позначив як застарілі.

### 1.3 Зробити індекс документації

Додати:

- `README.md` у корінь (коротко: що в репо, де документація).
- `docs/README.md` як індекс.

## 2) Прибирання “мертвих” файлів і дублікатів (✅ Done)

### 2.1 Web: зайві/непідключені сторінки (✅ Done)

- `client/src/pages/LoginPage.jsx` (removed/verified missing)

### 2.2 Mobile: дублікати адмін-екранів (✅ Done)

Навігація використовує `mobile/screens/admin/*`. Дублікати в `mobile/screens/` видалені/перевірені.

### 2.3 Тимчасові файли (✅ Done)

- `mobile/context/AuthContext.js.temp` (removed/moved)
- `mobile/tests/setup.js.temp` (removed/moved)
- `setup.js.temp` (removed/moved)

## 3) Прибирання заглушок у runtime (середній пріоритет)

### 3.1 OCR mock-режим

Зараз OCR на mobile при проблемах може повертати мокові дані. Це ризик (можна “не помітити”, що OCR не працює).

Рішення (обрати одне):

- **Dev-only mock**: mock дозволено лише в dev build (feature flag), у prod — показувати помилку.
- **Hard fail**: прибрати mock повністю.
- **Stabilize native**: довести `@react-native-ml-kit/text-recognition` до стабільного використання і покрити smoke-тестом.

### 3.2 Заглушка іконок MaterialCommunityIcons (✅ Done)

`mobile/MaterialCommunityIcons.js` архівовано. Додаток використовує `@expo/vector-icons` (Ionicons).

### 3.3 Статистика: пробіг (✅ Done)

`totalMileage` розраховується як різниця (max - min) пробігу в сервісних записах за обраний період. `mobile/api/servicesApi.js` оновлено, щоб повертати `mileage`.

## 4) Скрипти/сміття (низький–середній пріоритет)

- Перевірити та прибрати діагностичні скрипти, які не використовуються (особливо legacy-скрипти під Supabase).

## 4.1 Прибрати сліди Supabase (середній пріоритет)

Оскільки Supabase більше не використовується, важливо прибрати залишки з репо, щоб не вводити в оману:

- оновити `server/README.md` (Cloudflare D1 env vars замість `SUPABASE_*`)
- прибрати/заархівувати допоміжні скрипти з `SUPABASE_*` (якщо вони не використовуються)
- прибрати згадки Supabase з тестових/діагностичних артефактів і документації

## 5) Верифікація після прибирання

Мінімальний чек-лист перед тим, як вважати прибирання завершеним:

- Web стартує і відкриває логін/дашборд.
- API піднімається й відповідає на базові `/api/*`.
- Mobile збирається в Expo без заглушок, або з явним dev-flag.
- Telegram bot стартує і проходить базовий флоу логіну.
