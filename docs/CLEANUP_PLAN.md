# План прибирання репозиторію Avtoservis 2.0

Мета: зробити репо зрозумілим (одна “канонічна” документація), прибрати мертві/дубльовані файли, і винести тимчасові заглушки в явний dev-режим або прибрати.

## 0) Принципи

1. **Нічого не видаляємо “вслепу”**: кожен файл-кандидат перевіряється на імпорти/використання.
2. **Архівація краще за видалення** для документів/скриптів: спочатку переносимо в `docs/_archive/`.
3. **Одна правда**: у репо має бути один набір актуальних документів в `docs/`.

## 1) Нормалізація документації (високий пріоритет)

### 1.1 Визначити “канонічну” документацію

Фактичний стек репо зараз: **Node/Express + Cloudflare D1 (SQLite)**, web (React/Vite), mobile (Expo/RN), telegram-bot.

У `.trae/documents/` є кілька PRD/архітектурних варіантів. Тому:

- `docs/` = єдина підтримувана документація.
- `.trae/documents/` = генерації/чернетки, не вважаються джерелом істини.

### 1.2 Архівувати застарілі “топ-рівневі” документи

Кандидати в архів (позначити як legacy/застарілі або перенести в `docs/_archive/`):

- `AUDIT_REPORT.md`
- `DEBUGGING_PLAN.md`

Причина: ці файли були автогенеровані й користувач їх позначив як застарілі.

### 1.3 Зробити індекс документації

Додати:

- `README.md` у корінь (коротко: що в репо, де документація).
- `docs/README.md` як індекс.

## 2) Прибирання “мертвих” файлів і дублікатів (високий пріоритет)

### 2.1 Web: зайві/непідключені сторінки

- `client/src/pages/LoginPage.jsx` виглядає непідключеним (не імпортується). Рішення:
  - або видалити,
  - або зробити єдиною сторінкою логіну і прибрати дубль.

### 2.2 Mobile: дублікати адмін-екранів

Навігація використовує `mobile/screens/admin/*`, але в `mobile/screens/` лежать дублікати. Кандидати на видалення після перевірки імпортів:

- `mobile/screens/AdminStatisticsScreen.js`
- `mobile/screens/AppointmentsManagementScreen.js`
- `mobile/screens/PartsManagementScreen.js`
- `mobile/screens/ServicesManagementScreen.js`
- `mobile/screens/UsersManagementScreen.js`
- `mobile/screens/VehiclesManagementScreen.js`

Ціль: щоб у кожного екрану була **одна** “канонічна” реалізація.

### 2.3 Тимчасові файли

Кандидати на видалення/перенос в `docs/_archive/`:

- `mobile/context/AuthContext.js.temp`
- `mobile/tests/setup.js.temp`
- `setup.js.temp`

Правило: `.temp` не має лежати в репо без явної причини.

## 3) Прибирання заглушок у runtime (середній пріоритет)

### 3.1 OCR mock-режим

Зараз OCR на mobile при проблемах може повертати мокові дані. Це ризик (можна “не помітити”, що OCR не працює).

Рішення (обрати одне):

- **Dev-only mock**: mock дозволено лише в dev build (feature flag), у prod — показувати помилку.
- **Hard fail**: прибрати mock повністю.
- **Stabilize native**: довести `@react-native-ml-kit/text-recognition` до стабільного використання і покрити smoke-тестом.

### 3.2 Заглушка іконок MaterialCommunityIcons

`mobile/MaterialCommunityIcons.js` підміняє методи й повертає порожні ресурси. Це маскує проблему.

Рішення: знайти першопричину (шрифти/автолінкінг/Expo config) і прибрати заглушку.

### 3.3 Статистика: пробіг

`totalMileage` зараз 0. Потрібно визначити джерело істини (поле в `vehicles` чи в `service_records`) і порахувати.

## 4) Скрипти/сміття (низький–середній пріоритет)

- Перевірити та прибрати діагностичні скрипти, які не використовуються (особливо legacy-скрипти під Supabase).

## 4.1 Прибрати сліди Supabase (середній пріоритет)

Оскільки Supabase більше не використовується, важливо прибрати залишки з репо, щоб не вводити в оману:

- оновити `server/README.md` (Cloudflare D1 env vars замість `SUPABASE_*`)
- прибрати/заархівувати допоміжні скрипти з `SUPABASE_*` (якщо вони не використовуються)
- прибрати згадки Supabase з тестових/діагностичних артефактів і документації

## 5) Верифікація після прибирання

Мінімальний чек-лист перед тим, як вважати прибирання завершеним:

- Web стартує і відкриває логін/дашборд.
- API піднімається й відповідає на базові `/api/*`.
- Mobile збирається в Expo без заглушок, або з явним dev-flag.
- Telegram bot стартує і проходить базовий флоу логіну.

